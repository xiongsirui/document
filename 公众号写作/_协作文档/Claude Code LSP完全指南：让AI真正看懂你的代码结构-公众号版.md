# Claude Code LSP å®Œå…¨æŒ‡å—ï¼šè®© AI çœŸæ­£"çœ‹æ‡‚"ä½ çš„ä»£ç ç»“æ„

> ã€é…å›¾1ï¼šä¸»å›¾ - LSP æ¶æ„æ¦‚å¿µå›¾ã€‘

## å¼€ç¯‡ï¼šä»"çŒœ"åˆ°"çœ‹æ‡‚"ï¼Œè¿™æ˜¯è´¨çš„é£è·ƒ

å‰å‡ å¤©ç”¨ Claude Code åšä¸€ä¸ªé‡æ„ä»»åŠ¡ï¼Œæˆ‘è®©å®ƒæ‰¾ä¸€ä¸ªå‡½æ•°çš„æ‰€æœ‰è°ƒç”¨ä½ç½®ã€‚

ä»¥å‰å®ƒä¼šæ€ä¹ˆåšï¼Ÿç”¨ Grep æœç´¢å‡½æ•°åï¼Œç„¶å**çŒœ**å“ªäº›æ˜¯çœŸæ­£çš„è°ƒç”¨ã€å“ªäº›æ˜¯åŒåå˜é‡ã€å“ªäº›æ˜¯æ³¨é‡Šé‡Œçš„ã€‚

è¿™æ¬¡ä¸ä¸€æ ·ã€‚å®ƒç›´æ¥å‘Šè¯‰æˆ‘ï¼šã€Œè¿™ä¸ªå‡½æ•°åœ¨ 5 ä¸ªæ–‡ä»¶ä¸­è¢«è°ƒç”¨äº† 12 æ¬¡ã€ï¼Œæ¯ä¸€å¤„éƒ½ç²¾å‡†å®šä½åˆ°è¡Œå·ã€‚

æˆ‘æ„£äº†ä¸€ä¸‹ï¼Œè¿™ä¸å°±æ˜¯ IDE é‡Œçš„ã€ŒFind All Referencesã€å—ï¼Ÿ

æ²¡é”™ã€‚**Claude Code v2.0.74 æ­£å¼æ”¯æŒäº† LSPï¼ˆLanguage Server Protocolï¼‰**ã€‚

è¿™æ„å‘³ç€ï¼šClaude ä¸å†æ˜¯é "è¯»æ–‡æœ¬"æ¥ç†è§£ä»£ç äº†ï¼Œè€Œæ˜¯åƒ VS Code ä¸€æ ·ï¼ŒçœŸæ­£"çœ‹æ‡‚"ä»£ç çš„ç»“æ„ã€‚

ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä¼šè®²æ¸…æ¥šï¼š
- LSP æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆå®ƒå¯¹ AI ç¼–ç¨‹è¿™ä¹ˆé‡è¦
- æ€ä¹ˆåœ¨ Claude Code é‡Œå¯ç”¨å’Œä½¿ç”¨ LSP
- å®é™…åœºæ™¯ä¸‹èƒ½çœå¤šå°‘äº‹
- ç›®å‰çš„é™åˆ¶å’Œç»•è¿‡æ–¹æ³•

---

## Part 1ï¼šåŸç†ç¯‡ - LSP åˆ°åº•æ˜¯ä»€ä¹ˆ

### å…ˆè®²ä¸ªæ•…äº‹ï¼šç¼–è¾‘å™¨çš„"å·´åˆ«å¡”å›°å¢ƒ"

2016 å¹´ä¹‹å‰ï¼Œç¼–è¾‘å™¨å¼€å‘è€…æœ‰ä¸ªå¤´ç–¼çš„é—®é¢˜ï¼š

å‡è®¾ä½ è¦å¼€å‘ä¸€ä¸ªæ”¯æŒ 10 ç§ç¼–ç¨‹è¯­è¨€çš„ç¼–è¾‘å™¨ï¼Œæ¯ç§è¯­è¨€éƒ½è¦å®ç°ï¼š
- ä»£ç è¡¥å…¨
- è·³è½¬åˆ°å®šä¹‰
- æŸ¥æ‰¾å¼•ç”¨
- æ‚¬åœæç¤º
- é”™è¯¯è¯Šæ–­

é‚£å°±æ˜¯ 10 Ã— 5 = 50 ä¸ªåŠŸèƒ½æ¨¡å—è¦å†™ã€‚

å¦‚æœå†åŠ ä¸€ä¸ªæ–°ç¼–è¾‘å™¨å‘¢ï¼Ÿåˆæ˜¯ 50 ä¸ªã€‚

è¿™å°±æ˜¯ **M Ã— N é—®é¢˜**ï¼šM ä¸ªç¼–è¾‘å™¨ Ã— N ç§è¯­è¨€ = ç¾éš¾ã€‚

### å¾®è½¯çš„è§£æ³•ï¼šLSP

2016 å¹´ï¼Œå¾®è½¯æå‡ºäº† LSPï¼ˆLanguage Server Protocolï¼‰ï¼š

**æ ¸å¿ƒæ€æƒ³**ï¼šæŠŠã€Œè¯­è¨€æ™ºèƒ½ã€æŠ½å‡ºæ¥ï¼Œåšæˆç‹¬ç«‹çš„æœåŠ¡ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     JSON-RPC      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç¼–è¾‘å™¨     â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  è¯­è¨€æœåŠ¡å™¨   â”‚
â”‚  (Client)   â”‚                   â”‚  (Server)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     VS Code                         pyright
     Vim                            typescript
     Emacs                          rust-analyzer
     Claude Code                    gopls
```

ç¼–è¾‘å™¨åªéœ€è¦å®ç°ä¸€æ¬¡ LSP å®¢æˆ·ç«¯ï¼Œå°±èƒ½æ¥å…¥æ‰€æœ‰è¯­è¨€æœåŠ¡å™¨ã€‚
è¯­è¨€ç¤¾åŒºåªéœ€è¦å†™ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå°±èƒ½è¢«æ‰€æœ‰ç¼–è¾‘å™¨ä½¿ç”¨ã€‚

**M + N æ›¿ä»£äº† M Ã— N**ã€‚

### LSP èƒ½åšä»€ä¹ˆ

| èƒ½åŠ› | è¯´æ˜ | Claude Code ä¸­çš„ç”¨é€” |
|------|------|---------------------|
| **goToDefinition** | è·³è½¬åˆ°ç¬¦å·å®šä¹‰ | ç²¾å‡†å®šä½å‡½æ•°/ç±»çš„æºç ä½ç½® |
| **findReferences** | æŸ¥æ‰¾æ‰€æœ‰å¼•ç”¨ | é‡æ„æ—¶æ‰¾åˆ°æ‰€æœ‰è°ƒç”¨ç‚¹ |
| **documentSymbol** | æ–‡ä»¶ç¬¦å·æ¦‚è§ˆ | å¿«é€Ÿäº†è§£æ–‡ä»¶ç»“æ„ |
| **hover** | æ‚¬åœæç¤º | è·å–ç±»å‹ä¿¡æ¯å’Œæ–‡æ¡£ |
| **diagnostics** | é”™è¯¯è¯Šæ–­ | å®æ—¶å‘ç°è¯­æ³•/ç±»å‹é”™è¯¯ |

### ä¸ºä»€ä¹ˆè¿™å¯¹ AI ç¼–ç¨‹å¾ˆé‡è¦

**ä»¥å‰ Claude æ€ä¹ˆç†è§£ä»£ç ï¼Ÿ**

```
ç”¨æˆ·ï¼šå¸®æˆ‘æ‰¾åˆ° getUserById å‡½æ•°çš„å®šä¹‰

Claude çš„åšæ³•ï¼š
1. Grep æœç´¢ "getUserById"
2. çŒœæµ‹å“ªä¸ªæ˜¯å®šä¹‰ï¼ˆçœ‹æœ‰æ²¡æœ‰ function/def å…³é”®å­—ï¼‰
3. å¯èƒ½æ‰¾é”™ï¼ˆåŒåå‡½æ•°ã€æ³¨é‡Šã€å­—ç¬¦ä¸²é‡Œçš„éƒ½ä¼šåŒ¹é…åˆ°ï¼‰
```

**ç°åœ¨æœ‰äº† LSPï¼š**

```
ç”¨æˆ·ï¼šå¸®æˆ‘æ‰¾åˆ° getUserById å‡½æ•°çš„å®šä¹‰

Claude çš„åšæ³•ï¼š
1. è°ƒç”¨ LSP goToDefinition
2. ç›´æ¥è¿”å›ï¼šsrc/services/user.ts:42
3. 100% å‡†ç¡®
```

**æ ¸å¿ƒä»·å€¼**ï¼š
- âœ… **å‡†ç¡®æ€§**ï¼šä¸å†é çŒœï¼ŒLSP æ˜¯ç¡®å®šæ€§çš„
- âœ… **Token æ•ˆç‡**ï¼šä¸€æ¬¡ LSP è°ƒç”¨ vs å¤šæ¬¡ Grep + åˆ†æ
- âœ… **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**ï¼šç†è§£ä½œç”¨åŸŸã€ç±»å‹ã€ç»§æ‰¿å…³ç³»

---

## Part 2ï¼šå®æˆ˜ç¯‡ - æ€ä¹ˆå¯ç”¨å’Œä½¿ç”¨ LSP

### ç¬¬ä¸€æ­¥ï¼šå¯ç”¨ LSP åŠŸèƒ½

LSP åŠŸèƒ½ç›®å‰è¿˜éœ€è¦æ‰‹åŠ¨å¼€å¯ï¼š

```bash
# æ–¹å¼1ï¼šä¸´æ—¶å¯ç”¨
ENABLE_LSP_TOOL=1 claude

# æ–¹å¼2ï¼šæ°¸ä¹…å¯ç”¨ï¼ˆæ¨èï¼‰
# åœ¨ ~/.zshrc æˆ– ~/.bashrc ä¸­æ·»åŠ 
export ENABLE_LSP_TOOL=1
```

### ç¬¬äºŒæ­¥ï¼šå®‰è£…è¯­è¨€æœåŠ¡å™¨æ’ä»¶

Claude Code é€šè¿‡æ’ä»¶ç³»ç»Ÿé›†æˆå„è¯­è¨€çš„ LSP æœåŠ¡å™¨ï¼š

```bash
# Pythonï¼ˆä½¿ç”¨ pyrightï¼‰
/plugin install pyright@claude-code-lsps

# TypeScriptï¼ˆä½¿ç”¨ vtslsï¼‰
/plugin install vtsls@claude-code-lsps

# Rustï¼ˆä½¿ç”¨ rust-analyzerï¼‰
/plugin install rust-analyzer@claude-code-lsps

# Goï¼ˆä½¿ç”¨ goplsï¼‰
/plugin install gopls@claude-code-lsps
```

**æ”¯æŒçš„è¯­è¨€åˆ—è¡¨**ï¼š

| è¯­è¨€ | æœåŠ¡å™¨ | æ’ä»¶å‘½ä»¤ |
|------|--------|----------|
| Python | pyright | `pyright@claude-code-lsps` |
| TypeScript/JavaScript | vtsls | `vtsls@claude-code-lsps` |
| Rust | rust-analyzer | `rust-analyzer@claude-code-lsps` |
| Go | gopls | `gopls@claude-code-lsps` |
| Java | jdtls | `jdtls@claude-code-lsps` |
| C/C++ | clangd | `clangd@claude-code-lsps` |
| C# | omnisharp | `omnisharp@claude-code-lsps` |
| PHP | intelephense | `intelephense@claude-code-lsps` |
| Ruby | solargraph | `solargraph@claude-code-lsps` |
| Kotlin | kotlin-language-server | `kotlin@claude-code-lsps` |

### ç¬¬ä¸‰æ­¥ï¼šéªŒè¯ LSP æ˜¯å¦å·¥ä½œ

```bash
# å¯åŠ¨ Claude Code
claude

# è®©å®ƒä½¿ç”¨ LSP åŠŸèƒ½
"å¸®æˆ‘æ‰¾åˆ° main å‡½æ•°çš„å®šä¹‰ä½ç½®"

# å¦‚æœ LSP æ­£å¸¸å·¥ä½œï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„è¾“å‡ºï¼š
# Found definition at: src/main.py:15
```

---

## Part 3ï¼šåœºæ™¯ç¯‡ - LSP èƒ½å¸®ä½ çœå¤šå°‘äº‹

### åœºæ™¯ 1ï¼šç²¾å‡†é‡æ„

**ä»»åŠ¡**ï¼šæŠŠ `getUserById` é‡å‘½åä¸º `findUserById`

**ä»¥å‰ï¼ˆæ—  LSPï¼‰**ï¼š
```
Claudeï¼šè®©æˆ‘æœç´¢æ‰€æœ‰ä½¿ç”¨è¿™ä¸ªå‡½æ•°çš„åœ°æ–¹...
ï¼ˆGrep æœç´¢ï¼Œå¯èƒ½æ¼æ‰åŠ¨æ€è°ƒç”¨ï¼Œå¯èƒ½è¯¯æ”¹æ³¨é‡Šé‡Œçš„ï¼‰
æ”¹å®Œåï¼šå¯èƒ½æœ‰é—æ¼æˆ–è¯¯æ”¹
```

**ç°åœ¨ï¼ˆæœ‰ LSPï¼‰**ï¼š
```
Claudeï¼šä½¿ç”¨ findReferences æŸ¥æ‰¾æ‰€æœ‰å¼•ç”¨...
æ‰¾åˆ° 12 å¤„å¼•ç”¨ï¼š
- src/controllers/user.ts:23
- src/services/auth.ts:45
- src/tests/user.test.ts:12
...
å…¨éƒ¨ç²¾å‡†æ›¿æ¢ï¼Œæ— é—æ¼
```

### åœºæ™¯ 2ï¼šå¿«é€Ÿç†è§£é™Œç”Ÿä»£ç 

**ä»»åŠ¡**ï¼šæ¥æ‰‹ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæƒ³äº†è§£æŸä¸ªæ¨¡å—çš„ç»“æ„

**ä»¥å‰**ï¼š
```
ä½ ï¼šè¿™ä¸ª OrderService ç±»æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ
Claudeï¼šè®©æˆ‘è¯»ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶...ï¼ˆè¯»å–æ•´ä¸ªæ–‡ä»¶ï¼Œæ¶ˆè€—å¤§é‡ tokenï¼‰
```

**ç°åœ¨**ï¼š
```
ä½ ï¼šè¿™ä¸ª OrderService ç±»æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ
Claudeï¼šä½¿ç”¨ documentSymbol è·å–æ–‡ä»¶ç»“æ„...

OrderService ç±»åŒ…å«ä»¥ä¸‹æ–¹æ³•ï¼š
- createOrder(userId, items) -> Order
- cancelOrder(orderId) -> boolean
- getOrderStatus(orderId) -> OrderStatus
- listUserOrders(userId, page) -> Order[]
```

ä¸€æ¬¡ LSP è°ƒç”¨ï¼Œæ¯”è¯»æ•´ä¸ªæ–‡ä»¶çœå¤ªå¤š tokenã€‚

### åœºæ™¯ 3ï¼šç±»å‹æ„ŸçŸ¥çš„ä»£ç åˆ†æ

**ä»»åŠ¡**ï¼šæ£€æŸ¥æŸä¸ªå‡½æ•°çš„å‚æ•°ç±»å‹

```
ä½ ï¼šgetUserById æ¥æ”¶ä»€ä¹ˆå‚æ•°ï¼Œè¿”å›ä»€ä¹ˆç±»å‹ï¼Ÿ

Claudeï¼ˆä½¿ç”¨ hoverï¼‰ï¼š
getUserById(id: string): Promise<User | null>

å‚æ•°ï¼š
- id: string - ç”¨æˆ·ID

è¿”å›å€¼ï¼š
- Promise<User | null> - ç”¨æˆ·å¯¹è±¡æˆ– null
```

è¿™äº›ç±»å‹ä¿¡æ¯ä»¥å‰éœ€è¦ Claude è‡ªå·±ä»ä»£ç é‡Œæ¨æ–­ï¼Œç°åœ¨ç›´æ¥ä» LSP è·å–ã€‚

### åœºæ™¯ 4ï¼šå®æ—¶é”™è¯¯æ£€æµ‹

**ä»»åŠ¡**ï¼šå†™å®Œä»£ç ï¼Œè®© Claude å¸®å¿™æ£€æŸ¥

```
ä½ ï¼šå¸®æˆ‘æ£€æŸ¥è¿™ä¸ªæ–‡ä»¶æœ‰æ²¡æœ‰ç±»å‹é”™è¯¯

Claudeï¼ˆä½¿ç”¨ diagnosticsï¼‰ï¼š
å‘ç° 3 ä¸ªé—®é¢˜ï¼š

1. src/user.ts:23 - ç±»å‹é”™è¯¯
   'string' ä¸èƒ½èµ‹å€¼ç»™ 'number'

2. src/user.ts:45 - æœªä½¿ç”¨çš„å˜é‡
   'tempData' å·²å£°æ˜ä½†ä»æœªä½¿ç”¨

3. src/user.ts:67 - å¯èƒ½ä¸º null
   'user' å¯èƒ½ä¸º nullï¼Œä½†è¢«å½“ä½œé null ä½¿ç”¨
```

è¿™æ¯”è®© Claude è‡ªå·±åˆ†æä»£ç å‡†ç¡®å¤šäº†ã€‚

---

## Part 4ï¼šé¿å‘ç¯‡ - å·²çŸ¥é™åˆ¶å’Œè§£å†³æ–¹æ¡ˆ

### å‘ 1ï¼šLSP åŠŸèƒ½é»˜è®¤å…³é—­

**é—®é¢˜**ï¼šå¾ˆå¤šäººä¸çŸ¥é“è¦æ‰‹åŠ¨å¼€å¯ã€‚

**è§£å†³**ï¼š
```bash
# åŠ åˆ° shell é…ç½®æ–‡ä»¶
echo 'export ENABLE_LSP_TOOL=1' >> ~/.zshrc
source ~/.zshrc
```

### å‘ 2ï¼šè¯­è¨€æœåŠ¡å™¨éœ€è¦å•ç‹¬å®‰è£…

**é—®é¢˜**ï¼šè£…å®Œæ’ä»¶è¿˜è¦ç¡®ä¿è¯­è¨€æœåŠ¡å™¨æœ¬èº«å¯ç”¨ã€‚

**è§£å†³**ï¼š

```bash
# Python - pyright
npm install -g pyright

# Rust - rust-analyzer
rustup component add rust-analyzer

# TypeScript - é€šå¸¸é¡¹ç›®é‡Œå·²ç»æœ‰äº†
npm install -g typescript
```

### å‘ 3ï¼šLSP API éœ€è¦ç²¾ç¡®çš„è¡Œåˆ—å·

è¿™æ˜¯ Elixir åˆ›å§‹äºº JosÃ© Valim æŒ‡å‡ºçš„é—®é¢˜ï¼š

> "LSP APIs are awkward for agentic usage because they require passing file:line:column, you can't simply ask 'tell me where Foo#bar is defined.'"

**é—®é¢˜**ï¼šClaude æœ‰æ—¶å€™æŠ¥çš„è¡Œåˆ—å·ä¸å‡†ï¼Œå¯¼è‡´ LSP è°ƒç”¨å¤±è´¥ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

ç¤¾åŒºæœ‰ä¸ªé¡¹ç›®å« **cclsp**ï¼Œä¸“é—¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®ƒä¼šæ™ºèƒ½å°è¯•å¤šä¸ªä½ç½®ç»„åˆï¼Œæä¾›æ›´é²æ£’çš„ç¬¦å·è§£æã€‚

```bash
# å®‰è£… cclspï¼ˆä½œä¸º MCP æœåŠ¡å™¨ï¼‰
# è¯¦è§ï¼šhttps://github.com/ktnyt/cclsp
```

### å‘ 4ï¼šæ²¡æœ‰ UI åé¦ˆ

**é—®é¢˜**ï¼šç›®å‰ Claude Code çš„ LSP åŠŸèƒ½ã€Œpretty rawã€ï¼Œæ²¡æœ‰ç•Œé¢æ˜¾ç¤º LSP æœåŠ¡å™¨çš„çŠ¶æ€ã€‚

**è§£å†³**ï¼š
- çœ‹ Claude çš„è¾“å‡ºæ˜¯å¦æåˆ°ã€ŒLSPã€
- æ£€æŸ¥è¯­è¨€æœåŠ¡å™¨è¿›ç¨‹æ˜¯å¦åœ¨è¿è¡Œ
- æŸ¥çœ‹æ—¥å¿—ï¼š`claude --debug`

### å‘ 5ï¼šå¤§å‹é¡¹ç›®é¦–æ¬¡ç´¢å¼•æ…¢

**é—®é¢˜**ï¼šè¯­è¨€æœåŠ¡å™¨é¦–æ¬¡å¯åŠ¨éœ€è¦ç´¢å¼•æ•´ä¸ªé¡¹ç›®ï¼Œå¯èƒ½å¾ˆæ…¢ã€‚

**è§£å†³**ï¼š
- è€å¿ƒç­‰å¾…é¦–æ¬¡ç´¢å¼•å®Œæˆ
- è€ƒè™‘ç”¨ `.gitignore` æ’é™¤ `node_modules` ç­‰ç›®å½•
- rust-analyzer å¯ä»¥é…ç½®å¢é‡ç´¢å¼•

---

## Part 5ï¼šè¿›é˜¶ç¯‡ - LSP çš„æœ€ä½³å®è·µ

### 1. å–„ç”¨ documentSymbol äº†è§£ä»£ç ç»“æ„

åœ¨å¼€å§‹ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶ä¹‹å‰ï¼Œå…ˆè®© Claude ç”¨ LSP è·å–æ–‡ä»¶ç»“æ„ï¼š

```
ä½ ï¼šç”¨ LSP å‘Šè¯‰æˆ‘ src/services/order.ts çš„ç»“æ„

Claudeï¼š
OrderService (class)
â”œâ”€â”€ constructor(db: Database)
â”œâ”€â”€ createOrder(userId, items): Promise<Order>
â”œâ”€â”€ cancelOrder(orderId): Promise<boolean>
â”œâ”€â”€ getOrderStatus(orderId): OrderStatus
â””â”€â”€ private validateItems(items): boolean

OrderStatus (enum)
â”œâ”€â”€ PENDING
â”œâ”€â”€ PROCESSING
â”œâ”€â”€ COMPLETED
â””â”€â”€ CANCELLED
```

è¿™æ¯”è¯»æ•´ä¸ªæ–‡ä»¶é«˜æ•ˆå¤šäº†ã€‚

### 2. é‡æ„å‰å…ˆç”¨ findReferences

ä»»ä½•æ¶‰åŠæ”¹åã€åˆ é™¤çš„é‡æ„ï¼Œå…ˆç¡®è®¤å½±å“èŒƒå›´ï¼š

```
ä½ ï¼šåœ¨æ”¹è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œå¸®æˆ‘æ‰¾åˆ°æ‰€æœ‰ä½¿ç”¨å®ƒçš„åœ°æ–¹

Claudeï¼š
findReferences ç»“æœï¼š
- src/controllers/user.ts:23 (è°ƒç”¨)
- src/controllers/admin.ts:45 (è°ƒç”¨)
- src/tests/user.test.ts:12 (æµ‹è¯•)
- src/types/index.ts:8 (ç±»å‹å¯¼å‡º)

å…± 4 ä¸ªæ–‡ä»¶ï¼Œ6 å¤„å¼•ç”¨
```

### 3. ç»“åˆ diagnostics åšä»£ç å®¡æŸ¥

å†™å®Œä»£ç åï¼Œè®© Claude ç”¨ LSP æ£€æŸ¥é—®é¢˜ï¼š

```
ä½ ï¼šç”¨ LSP diagnostics æ£€æŸ¥è¿™ä¸ªæ–‡ä»¶

Claudeï¼š
æ£€æµ‹åˆ°ä»¥ä¸‹é—®é¢˜ï¼š
1. ç±»å‹é”™è¯¯ 2 ä¸ª
2. æœªä½¿ç”¨å˜é‡ 3 ä¸ª
3. å¯èƒ½çš„ null å¼•ç”¨ 1 ä¸ª

æ˜¯å¦éœ€è¦æˆ‘é€ä¸€ä¿®å¤ï¼Ÿ
```

### 4. è·¨æ–‡ä»¶åˆ†æç”¨ goToDefinition é“¾

ç†è§£å¤æ‚çš„è°ƒç”¨é“¾ï¼š

```
ä½ ï¼šå¸®æˆ‘è¿½è¸ª handleUserLogin çš„è°ƒç”¨é“¾

Claudeï¼š
handleUserLogin (src/handlers/auth.ts:15)
â””â”€â”€ è°ƒç”¨ authService.validateCredentials (src/services/auth.ts:42)
    â””â”€â”€ è°ƒç”¨ userRepository.findByEmail (src/repositories/user.ts:23)
        â””â”€â”€ è°ƒç”¨ db.query (src/database/index.ts:56)
```

---

## Part 6ï¼šå¿«é€Ÿå‚è€ƒ

### ç¯å¢ƒå˜é‡

```bash
export ENABLE_LSP_TOOL=1  # å¯ç”¨ LSP åŠŸèƒ½
```

### å¸¸ç”¨æ’ä»¶å®‰è£…å‘½ä»¤

```bash
/plugin install pyright@claude-code-lsps      # Python
/plugin install vtsls@claude-code-lsps        # TypeScript
/plugin install rust-analyzer@claude-code-lsps # Rust
/plugin install gopls@claude-code-lsps        # Go
```

### LSP èƒ½åŠ›é€ŸæŸ¥

| èƒ½åŠ› | ç”¨é€” | ç¤ºä¾‹ prompt |
|------|------|------------|
| goToDefinition | æ‰¾å®šä¹‰ | "æ‰¾åˆ° XXX å‡½æ•°çš„å®šä¹‰" |
| findReferences | æ‰¾å¼•ç”¨ | "æ‰¾åˆ°æ‰€æœ‰ä½¿ç”¨ XXX çš„åœ°æ–¹" |
| documentSymbol | æ–‡ä»¶ç»“æ„ | "è¿™ä¸ªæ–‡ä»¶æœ‰å“ªäº›ç±»å’Œæ–¹æ³•" |
| hover | ç±»å‹ä¿¡æ¯ | "XXX çš„å‚æ•°å’Œè¿”å›ç±»å‹æ˜¯ä»€ä¹ˆ" |
| diagnostics | é”™è¯¯æ£€æµ‹ | "æ£€æŸ¥è¿™ä¸ªæ–‡ä»¶æœ‰æ²¡æœ‰ç±»å‹é”™è¯¯" |

---

## æ€»ç»“ï¼šè¿™æ˜¯ AI ç¼–ç¨‹çš„åŸºç¡€è®¾æ–½å‡çº§

LSP å¯¹ Claude Code çš„æ„ä¹‰ï¼Œå°±åƒ GPS å¯¹å¯¼èˆªçš„æ„ä¹‰ã€‚

ä»¥å‰ Claude ç†è§£ä»£ç ï¼Œé çš„æ˜¯ã€Œé˜…è¯»ç†è§£ã€â€”â€”è¯»æ–‡æœ¬ã€çŒœå«ä¹‰ã€‚
ç°åœ¨æœ‰äº† LSPï¼Œå®ƒèƒ½ç›´æ¥ã€ŒæŸ¥åœ°å›¾ã€â€”â€”è°ƒç”¨è¯­è¨€æœåŠ¡å™¨ï¼Œè·å–ç²¾ç¡®ä¿¡æ¯ã€‚

**å®é™…æ”¶ç›Š**ï¼š
- ğŸ¯ **å‡†ç¡®æ€§æå‡**ï¼šä¸å†é çŒœï¼ŒLSP æŸ¥è¯¢æ˜¯ç¡®å®šæ€§çš„
- ğŸ’° **Token èŠ‚çœ**ï¼šä¸€æ¬¡ LSP è°ƒç”¨ vs å¤šæ¬¡ Grep + åˆ†æ
- âš¡ **æ•ˆç‡æå‡**ï¼šé‡æ„ã€ä»£ç å®¡æŸ¥ã€ç†è§£é™Œç”Ÿä»£ç éƒ½æ›´å¿«

**ç›®å‰çš„çŠ¶æ€**ï¼š

è¯´å®è¯ï¼Œè¿™ä¸ªåŠŸèƒ½ç°åœ¨è¿˜æŒºã€Œæ¯›å¯ã€çš„ã€‚è¦æ‰‹åŠ¨å¼€å¯ã€è¦è£…æ’ä»¶ã€æ²¡æœ‰ UI åé¦ˆã€å¶å°”è¿˜æœ‰ bugã€‚

ä½†è¿™æ˜¯æ­£ç¡®çš„æ–¹å‘ã€‚Hacker News ä¸Š 222 ä¸ª upvote è¯´æ˜ç¤¾åŒºå¾ˆè®¤å¯è¿™ä¸ªæ–¹å‘ã€‚

**æˆ‘çš„å»ºè®®**ï¼š

1. **ç°åœ¨å°±å¯ç”¨**ï¼šåŠ ä¸Š `ENABLE_LSP_TOOL=1`ï¼Œä½“éªŒä¸€ä¸‹
2. **ä»å¸¸ç”¨è¯­è¨€å¼€å§‹**ï¼šå…ˆè£…ä½ æœ€å¸¸ç”¨çš„è¯­è¨€æœåŠ¡å™¨
3. **æ…¢æ…¢å…»æˆä¹ æƒ¯**ï¼šè®© Claude åœ¨é‡æ„å‰å…ˆ findReferencesï¼Œå†™å®Œåç”¨ diagnostics æ£€æŸ¥

è¿™æ˜¯åŸºç¡€è®¾æ–½çº§çš„å‡çº§ï¼Œè¶Šæ—©é€‚åº”è¶Šå¥½ã€‚

---

> ã€é…å›¾2ï¼šç»“å°¾å›¾ - ä»£ç å¯¼èˆªç¤ºæ„å›¾ã€‘

## ç›¸å…³èµ„æº

- Claude Code å®˜æ–¹æ–‡æ¡£ï¼šhttps://code.claude.com/docs
- LSP å®˜æ–¹ç½‘ç«™ï¼šhttps://microsoft.github.io/language-server-protocol/
- Claude Code LSP æ’ä»¶åˆé›†ï¼šhttps://github.com/boostvolt/claude-code-lsps
- cclspï¼ˆå¢å¼º LSP é›†æˆï¼‰ï¼šhttps://github.com/ktnyt/cclsp
- Hacker News è®¨è®ºï¼šhttps://news.ycombinator.com/item?id=46355165

---

*è¿™æ˜¯ Claude Code ç³»åˆ—çš„ç¬¬å››ç¯‡ã€‚ä¹‹å‰å†™è¿‡ã€ŠAgents å®æˆ˜æŒ‡å—ã€‹ã€ŠSkills å®Œå…¨æŒ‡å—ã€‹ã€ŠBackground Agents å®Œå…¨æŒ‡å—ã€‹ï¼Œæ„Ÿå…´è¶£å¯ä»¥ç¿»ç¿»å†å²æ–‡ç« ã€‚*

*æœ‰é—®é¢˜æ¬¢è¿è¯„è®ºåŒºè®¨è®ºã€‚*

---

**å…¨æ–‡çº¦ 3200 å­—ï¼Œé˜…è¯»æ—¶é—´çº¦ 9 åˆ†é’Ÿ**
