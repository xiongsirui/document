---
name: router
description: 智能工作区路由器 - 自动识别任务类型并调用对应工作区
author: Claude Code
version: 2.0.0
requires_backend: false
priority: highest
---

# 工作区路由器

这是整个系统的入口，实现 **两层判断机制**。

## 第一层：工作区判断

AI 首先判断任务属于哪个工作区：

| 工作区 | 触发关键词 | 配置文件 |
|--------|-----------|----------|
| 公众号写作 | 公众号、文章、写作、内容创作、推文 | `_workspaces/公众号/` |
| 视频创作 | 视频、脚本、剪辑、短视频、Vlog | `_workspaces/视频/` |
| Prompt优化 | prompt、提示词、AI指令 | `_workspaces/Prompt/` |
| 通用任务 | 其他所有任务 | 灵活处理 |

## 第二层：任务类型判断

确定工作区后，判断具体任务类型：

```
A. 新写作任务（有完整brief）→ 完整9步流程
B. 新写作任务（无brief只有需求）→ 先创建brief再执行流程
C. 修改已有文章 → 读取原文 → 理解需求 → 修改
D. 文章审校/降AI味 → 三遍审校流程
E. 快速咨询 → 直接回答
```

## 使用方法

### 自动模式（推荐）
直接描述需求，系统自动识别：
```
写一篇关于AI的公众号文章
做个3分钟产品介绍视频
优化这个prompt
```

### 手动指定工作区
```
[公众号] 写一篇关于AI的文章
[视频] 做个产品介绍视频
[Prompt] 优化这个提示词
[通用] 帮我分析这个问题
```

### 切换工作区
```
[切换到视频] 把这篇文章改成视频脚本
[切换到Prompt] 总结成提示词模板
```

## 判断流程示例

### 示例1：公众号文章
```
用户：帮我写一篇关于Claude Code的公众号文章

系统判断：
├─ 第一层：关键词"公众号" → 公众号写作工作区
├─ 第二层：新写作任务（无brief） → B类型
└─ 执行：先创建brief，再执行9步流程

响应：
[公众号] 已识别：公众号写作任务
[任务类型] B - 新写作任务（需先创建brief）
开始执行写作流程...
```

### 示例2：修改文章
```
用户：帮我把这篇文章的开头改得更吸引人

系统判断：
├─ 第一层：关键词"文章" → 公众号写作工作区
├─ 第二层：修改已有文章 → C类型
└─ 执行：读取原文 → 理解需求 → 修改

响应：
[公众号] 已识别：修改任务
[任务类型] C - 修改已有文章
请提供原文...
```

### 示例3：降AI味审校
```
用户：这篇文章AI味太重了，帮我降一下

系统判断：
├─ 第一层：关键词"文章" → 公众号写作工作区
├─ 第二层：审校/降AI味 → D类型
└─ 执行：三遍审校流程

响应：
[公众号] 已识别：降AI味任务
[任务类型] D - 文章审校/降AI味
开始三遍审校流程...
```

## 工作区特性对比

| 特性 | 公众号 | 视频 | Prompt | 通用 |
|------|--------|------|--------|------|
| 需要配图 | ✅ | ❌ | ❌ | 按需 |
| SEO优化 | ✅ | ❌ | ❌ | ❌ |
| 字数限制 | ✅ | ❌ | ✅ | ❌ |
| 分镜头 | ❌ | ✅ | ❌ | ❌ |
| 结构化 | ✅ | ✅ | ✅ | 按需 |
| 三遍审校 | ✅ | ❌ | ❌ | 按需 |
| 个人素材库 | ✅ | ✅ | ❌ | 按需 |

## 组合任务

支持复杂组合任务：
```
[组合] 先写公众号文章，再改编成视频脚本
```

执行流程：
1. 先执行公众号工作区
2. 完成后自动切换到视频工作区
3. 基于文章内容生成脚本

## 模糊任务处理

当任务描述不明确时，系统会询问：

```
用户：帮我做内容

系统：请选择内容类型：
1. 公众号文章
2. 视频脚本
3. Prompt优化
4. 其他（请说明）
```

## 相关文件

- 核心原则：[core_principles.md](core_principles.md)
- Think Aloud：[think_aloud.md](think_aloud.md)
- 任务分类器：[task_classifier.md](task_classifier.md)
